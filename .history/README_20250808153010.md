# Safe Python Executor

Secure Python script execution API using Flask and nsjail sandbox.

## Features

- Executes user scripts safely in nsjail sandbox  
- Returns JSON from main() function only  
- Supports libraries: os, pandas, numpy  
- Basic input validation  
- Dockerized for local use and deployable on Google Cloud Run

## Quickstart

### Build Docker image:

```bash
docker build -t safe-python-executor .

# Run locally
docker run -p 8080:8080 safe-python-executor

#  bellow are some of the cURL commands you could run locally to test the Test with cURL
curl -X POST http://localhost:8080/execute \
  -H "Content-Type: application/json" \
  -d '{"script": "def main():\n return {\"msg\": \"hello\"}"}'

curl -X POST http://localhost:8080/execute \
  -H "Content-Type: application/json" \
  -d '{
    "script": "import pandas as pd\n\ndef main():\n    df = pd.DataFrame({\"name\": [\"Alice\", \"Bob\"], \"score\": [85, 92]})\n    avg = df[\"score\"].mean()\n    return {\"average_score\": avg}"
  }'

curl -X POST http://localhost:8080/execute \
  -H "Content-Type: application/json" \
  -d '{
    "script": "import numpy as np\n\ndef main():\n    arr = np.array([1, 2, 3, 4])\n    return {\"mean\": np.mean(arr).item(), \"sum\": np.sum(arr).item()}"
  }'

curl -X POST http://localhost:8080/execute \
  -H "Content-Type: application/json" \
  -d '{
    "script": "import os\n\ndef main():\n    return {\"os_name\": os.name}"
  }'

curl -X POST http://localhost:8080/execute \
  -H "Content-Type: application/json" \
  -d '{
    "script": "import os\n\ndef main():\n    return {\"files\": os.listdir(\"/\")}"
  }'

curl -X POST http://localhost:8080/execute \
  -H "Content-Type: application/json" \
  -d '{
    "script": "import os\n\ndef main():\n    return {\"env\": dict(os.environ)}"
  }'

curl -X POST http://localhost:8080/execute \
  -H "Content-Type: application/json" \
  -d '{
    "script": "def main():\n    try:\n        with open(\"/etc/passwd\", \"r\") as f:\n            content = f.read()\n        return {\"lines\": content.splitlines()[:5]}\n    except Exception as e:\n        return {\"error\": str(e)}"
  }'


### Or 

Service URL: https://safe-python-executor-r3bafn6d3a-uc.a.run.app
name: "python_sandbox"
description: "Restricts Python script execution"
mode: EXECVE
stderr_to_null: false

envar: "PYTHONPATH=/usr/local/lib/python3.11/site-packages:/usr/local/lib/python3.11/dist-packages"

mount { src: "/scripts" dst: "/scripts" is_bind: true is_dir: true rw: true }
mount { src: "/tmp" dst: "/tmp" is_bind: true is_dir: true rw: true }
mount { src: "/usr" dst: "/usr" is_bind: true is_dir: true rw: false }
mount { src: "/lib" dst: "/lib" is_bind: true is_dir: true rw: false }
mount { src: "/lib64" dst: "/lib64" is_bind: true is_dir: true rw: false mandatory: false }
mount { src: "/usr/local/lib" dst: "/usr/local/lib" is_bind: true is_dir: true rw: false }
mount { src: "/usr/local/lib/python3.11/site-packages" dst: "/usr/local/lib/python3.11/site-packages" is_bind: true is_dir: true rw: false }
mount {
  src: "/usr/local/lib/python3.11/dist-packages"
  dst: "/usr/local/lib/python3.11/dist-packages"
  is_bind: true
  rw: false
  is_dir: true
}
exec_bin {
  path: "/usr/bin/python3"
  arg: "/scripts/sandboxed.py"
}

cwd: "/scripts"

rlimit_as: 512
rlimit_cpu: 5
rlimit_fsize: 10240
rlimit_nofile: 32

clone_newuser: false
clone_newnet: false
